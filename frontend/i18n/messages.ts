export const messages: Record<string, Record<string, string>> = {
  en: {
    appTitle: 'Document Analyzer',
    appSubtitle: 'Upload, analyze, and test your knowledge.',
    loading: 'Loading...',
    errorGeneric: 'Something went wrong',
    selectLanguage: 'Select language',
    library: 'Library',
    new: 'New',
    add: 'Add',
    cancel: 'Cancel',
    creatingCollection: 'Creating collection...',
    collectionCreated: 'Collection created',
    removingCollection: 'Removing collection...',
    collectionRemoved: 'Collection removed',
    failedLoadCollections: 'Failed to load collections',
    failedCreateCollection: 'Failed to create collection',
    failedRemoveCollection: 'Failed to remove collection',
    nameRequired: 'Name required',
    refreshCollections: 'Refresh collections',
    collectionName: 'Collection name',
    back: 'Back',
    backAllDocuments: 'Back to all documents',
    allDocuments: 'All Documents',
    unnamed: 'Unnamed',
    selectCollection: 'Select collection',
    removeCollection: 'Remove collection',
    remove: 'Remove',
    libraryTips: 'Library tips:',
    tipClickCollection: 'Click a collection to filter',
    tipOpenItem: 'Open an item to view details',
    failedLoadDocuments: 'Failed to load documents',
    noDocuments: 'No documents yet.',
    refreshDocuments: 'Refresh documents',
    total: 'Total',
    selectDocumentHint: 'Select a document to load its latest analysis',
    saveToCollection: 'Save to collection',
    savedTo: 'Saved to',
    dragDrop: 'Drag & drop files here',
    orBrowse: 'or click to browse (max 10)',
    clear: 'Clear',
    analyze: 'Analyze',
    analyzing: 'Analyzing...',
    noAnalysis: 'No analysis yet. Upload files to begin.',
    reused: 'Reused',
    batch: 'Batch',
    summary: 'Summary',
    sentiment: 'Sentiment',
    keywords: 'Keywords',
    fullText: 'Full Text',
    takeQuiz: 'Take Quiz',
    preparingQuiz: 'Preparing quiz...',
    clearAnalysis: 'Clear',
    analysisStarted: 'Analysis started...',
    loadedPreviousAnalyses: 'Loaded previous analyses',
    analysisComplete: 'Analysis complete',
    analysisCompleteExclaim: 'Analysis complete!',
    analysisFailed: 'Analysis failed.',
    loadedDocumentAnalysis: 'Loaded document analysis',
    failedLoadDocumentsToast: 'Failed to load documents',
    generatingQuiz: 'Generating quiz...',
    quizReady: 'Quiz is ready!',
    quizFailed: 'Quiz generation failed.',
    quizCompleted: 'Quiz completed!',
    analysisLoadedCount: 'Loaded {count} document(s)',
    folderDocumentsLoading: 'Loading documents...',
    folderNoDocuments: 'No documents',
    confirmClearTitle: 'Clear analysis',
    confirmClearDescription: 'This will remove the current analysis results. Continue?',
    confirm: 'Confirm',
    footerOpenSource: 'Open source on',
    footerStar: 'Star the project',
    footerBy: 'Built by',
    notes: 'Notes',
    sections: 'sections',
    document: 'Document',
    of: 'of',
    export: 'Export',
    exportWord: 'Word (.docx)',
    exportPdf: 'PDF (.pdf)',
    highlightKeywords: 'Highlight keywords',
    hideKeywordsHighlight: 'Hide keyword highlights',
    search: 'Search',
    clearSearch: 'Clear search',
    previousMatch: 'Previous match',
    nextMatch: 'Next match',
    matches: 'matches',
    addNote: 'Add note',
    save: 'Save',
    edit: 'Edit',
    delete: 'Delete',
    noNotesYet: 'No notes yet.',
    noKeywordsFound: 'No keywords identified for this document.',
    noSections: 'No sections detected.',
    noTextSections: 'No text available to display.',
    uploadDocumentHint: 'Upload a document or return to the summary tab.',
    summaryLevel: 'Level',
    detailed: 'Detailed',
    short: 'Short',
    bullet: 'Bullets',
    // Onboarding
    onboardStepTabsTitle: 'Navigation',
    onboardStepTabsBody: 'Use the tabs to switch between Summary, Text, Keywords, Quiz, Statistics and Notes.',
    onboardStepTextTitle: 'Reading & Notes',
    onboardStepTextBody: 'In the Text tab you can search, highlight keywords and add notes per section.',
    onboardStepNotesTitle: 'Notes Management',
    onboardStepNotesBody: 'Notes persist locally and are grouped in the Notes tab.',
    skip: 'Skip',
    next: 'Next',
    finish: 'Finish',
    navigation: 'Navigation',
    readingNotes: 'Reading & Notes',
    notesManagement: 'Notes Management',
    level: 'Level',
    dash: '—',
    noNotesAddFirst: 'No notes yet. Switch to the text tab to add your first note.',
    exportSuccess: 'Export completed',
    exportFailed: 'Export failed',
  },
  pt: {
    appTitle: 'Document Analyzer',
    appSubtitle: 'Carregue, analise e teste o seu conhecimento.',
    loading: 'A carregar...',
    errorGeneric: 'Ocorreu um erro',
    selectLanguage: 'Selecionar idioma',
    library: 'Biblioteca',
    new: 'Nova',
    add: 'Adicionar',
    cancel: 'Cancelar',
    creatingCollection: 'A criar coleção...',
    collectionCreated: 'Coleção criada',
    removingCollection: 'A remover coleção...',
    collectionRemoved: 'Coleção removida',
    failedLoadCollections: 'Falha ao carregar coleções',
    failedCreateCollection: 'Falha ao criar coleção',
    failedRemoveCollection: 'Falha ao remover coleção',
    nameRequired: 'Nome obrigatório',
    refreshCollections: 'Atualizar coleções',
    collectionName: 'Nome da coleção',
    back: 'Voltar',
    backAllDocuments: 'Voltar a todos os documentos',
    allDocuments: 'Todos os Documentos',
    unnamed: 'Sem nome',
    selectCollection: 'Selecionar coleção',
    removeCollection: 'Remover coleção',
    remove: 'Remover',
    libraryTips: 'Dicas:',
    tipClickCollection: 'Clique numa coleção para filtrar',
    tipOpenItem: 'Abra um item para ver detalhes',
    failedLoadDocuments: 'Falha ao carregar documentos',
    noDocuments: 'Sem documentos ainda.',
    refreshDocuments: 'Atualizar documentos',
    total: 'Total',
    selectDocumentHint: 'Selecione um documento para carregar a última análise',
    saveToCollection: 'Guardar na coleção',
    savedTo: 'Guardado em',
    dragDrop: 'Arraste e largue ficheiros aqui',
    orBrowse: 'ou clique para procurar (máx 10)',
    clear: 'Limpar',
    analyze: 'Analisar',
    analyzing: 'A analisar...',
    noAnalysis: 'Ainda sem análises. Carregue ficheiros para começar.',
    reused: 'Reutilizado',
    batch: 'Lote',
    summary: 'Resumo',
    sentiment: 'Sentimento',
    keywords: 'Palavras-chave',
    fullText: 'Texto Completo',
    takeQuiz: 'Fazer Quiz',
    preparingQuiz: 'A preparar quiz...',
    clearAnalysis: 'Limpar',
    analysisStarted: 'Análise iniciada...',
    loadedPreviousAnalyses: 'Análises anteriores carregadas',
    analysisComplete: 'Análise completa',
    analysisCompleteExclaim: 'Análise completa!',
    analysisFailed: 'Falha na análise.',
    loadedDocumentAnalysis: 'Análise carregada',
    failedLoadDocumentsToast: 'Falha ao carregar documentos',
    generatingQuiz: 'A gerar quiz...',
    quizReady: 'Quiz pronto!',
    quizFailed: 'Falha ao gerar quiz.',
    quizCompleted: 'Quiz concluído!',
    analysisLoadedCount: 'Carregados {count} documentos',
    folderDocumentsLoading: 'A carregar documentos...',
    folderNoDocuments: 'Sem documentos',
    confirmClearTitle: 'Limpar análise',
    confirmClearDescription: 'Isto irá remover os resultados atuais da análise. Continuar?',
    confirm: 'Confirmar',
    footerOpenSource: 'Código aberto em',
    footerStar: 'Dá uma estrela ao projeto',
    footerBy: 'Feito por',
    notes: 'Notas',
    sections: 'secções',
    document: 'Documento',
    of: 'de',
    export: 'Exportar',
    exportWord: 'Word (.docx)',
    exportPdf: 'PDF (.pdf)',
    highlightKeywords: 'Realçar palavras‑chave',
    hideKeywordsHighlight: 'Ocultar realce',
    search: 'Pesquisar',
    clearSearch: 'Limpar pesquisa',
    previousMatch: 'Anterior',
    nextMatch: 'Seguinte',
    matches: 'ocorrências',
    addNote: 'Adicionar nota',
    save: 'Guardar',
    edit: 'Editar',
    delete: 'Eliminar',
    noNotesYet: 'Sem notas ainda.',
    noKeywordsFound: 'Nenhuma palavra‑chave identificada para este documento.',
    noSections: 'Nenhuma secção detetada.',
    noTextSections: 'Sem texto para mostrar.',
    uploadDocumentHint: 'Carregue um documento ou volte ao separador de resumo.',
    summaryLevel: 'Nível',
    detailed: 'Detalhado',
    short: 'Curto',
    bullet: 'Marcadores',
    // Onboarding
    onboardStepTabsTitle: 'Navegação',
    onboardStepTabsBody: 'Usa as tabs para alternar entre Resumo, Texto, Palavras‑chave, Quiz, Estatísticas e Notas.',
    onboardStepTextTitle: 'Leitura & Notas',
    onboardStepTextBody: 'No separador Texto podes pesquisar, realçar palavras‑chave e adicionar notas por secção.',
    onboardStepNotesTitle: 'Gestão de Notas',
    onboardStepNotesBody: 'As notas persistem localmente e aparecem agrupadas no separador Notas.',
    skip: 'Saltar',
    next: 'Seguinte',
    finish: 'Concluir',
    navigation: 'Navegação',
    readingNotes: 'Leitura & Notas',
    notesManagement: 'Gestão de Notas',
    level: 'Nível',
    dash: '—',
    noNotesAddFirst: 'Sem notas ainda. Vai ao separador Texto para adicionar a primeira.',
    exportSuccess: 'Exportação concluída',
    exportFailed: 'Falha na exportação',
  }
};

export type Locale = keyof typeof messages; // dynamic based on keys
export const defaultLocale: Locale = 'en';
export const availableLocales: Locale[] = Object.keys(messages) as Locale[];

export function normalizeLocale(input: string): Locale {
  if (!input) return defaultLocale;
  const lower = input.toLowerCase();
  if ((messages as Record<string, Record<string,string>>)[lower]) return lower as Locale;
  const pref = lower.split('-')[0];
  if ((messages as Record<string, Record<string,string>>)[pref]) return pref as Locale;
  return defaultLocale;
}

export function t(lang: string, key: string, vars?: Record<string,string|number>): string {
  const safeLang = normalizeLocale(lang);
  const dict = messages[safeLang] || messages.en;
  let str = dict[key] || key;
  if (vars) {
    Object.entries(vars).forEach(([k,v]) => {
      str = str.replace(new RegExp(`{${k}}`, 'g'), String(v));
    });
  }
  return str;
}
